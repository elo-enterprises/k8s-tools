{% import 'macros.j2' as macros -%}

## API: compose.mk

### compose.mk: (Dynamic Targets)

The autogenerated section of the API (i.e. what's created by `compose.import`) is documented as part of the [Make/Compose Bridge](#makecompose-bridge).

### compose.mk: (Static Targets)

This is the complete list of namespaces & targets available from compose.mk, along with their documentation.  Most documentation is pulled automatically from [the latest source](compose.mk).  Some important notes about how these targets work:

* **No requirements for `k8s-tools.yml` or `k8s.mk`.**
* **Most targets are pure shell, and have no exotic dependencies.** That means that they generally run fine on host or as dispatched targets inside containers.  Be mindful of these exceptions though:  targets in `stream.json.*` require `jq` and targets in `docker.*` require docker.
* **Targets are usable interactively from your shell** as `make <target>` or `./compse.mk <target>`
* **Targets are usable as an API,** either as prereq-targets or as part of the body in your targets.
* **Target names are reserved names after declaration.**

Things are organized into a few namespaces, which hopefully avoids collisions with your project targets.

* [*`io.*`* targets:](/docs/api#api-io)  Misc text-formatters, timers, and other utilities
* [*`docker.*`* targets:](/docs/api#api-docker) targets: Simple helpers for working with docker.
* [*`flux.*`*](/docs/api#api-flux) targets: Miniature workflow library / pipe wizard.
* [*`tux.*`*  targets:](/docs/api#api-tux) targets: Embedded TUI support.
* [*`stream.*`* targets:](/docs/api#api-stream) targets: Support for IO streams, including basic stuff with JSON, newline-delimited, and space-delimited formats.

{% set help_extra="Docs below typically refer to `compose.mk` as the executable involved, but if you're using integrated rather than stand-alone mode, you should use `make` instead to work with your own project's context!" %}

#### API: tux

The *`tux.*`* targets allow for creation, configuration and automation of an embedded TUI interface.  See the [TUI documentation](#embedded-tui) for a high-level overview of what this is and how it works.  For more details, [see the main TUI docs](/#embedded-tui), read on into the API, or see the [tux container spec in compose.mk]({{macros.search_link('compose.mk', 'tux', github)}})

{{macros.parse_help('compose.mk', 'tux', help_extra)}}

#### API: io

The *`io.*`* targets cover various I/O helpers, text-formatters, and other utilities.

{{macros.parse_help('compose.mk', 'io', github)}}

#### API: docker

The *`docker.*`* targets cover a few helpers for working with docker.  This interface is deliberately minimal, focusing on verbs like 'stop' and 'stat' more than verbs like 'build' and 'run'.  That's because containers that are managed by `docker compose` are preferred, but for simple use-cases it's nice to avoid an almost-empty service definition.  See [`stream.pygmentize`](#streampygmentize) for an example.

{{macros.parse_help('compose.mk', 'docker', github)}}

#### API: flux

The *`flux.*`* targets describe a miniature workflow library.  

Combining `flux` with [container dispatch](#container-dispatch) is similar in spirit to things like [declarative pipelines in Jenkins](https://www.jenkins.io/doc/book/pipeline/syntax/#declarative-pipeline), but simpler, more portable, and significantly easier to use.  

The focus for these targets is on join/loop/map operations *over other make targets*, taking inspiration from functional programming and threading libraries.  For stuff that's more specific to shell code, see`flux.sh.*`, and for working with scripts see `flux.script.*`.  See also the [Platform Setup Example](#demo-platform-setup) for a more complete walk-through of motivation/use-case.

{{macros.parse_help('compose.mk','flux', github)}}

#### API: gum

The `gum.*` targets support usage of [charmbracelet/gum](#).  These targets generally use gum natively if available, falling back to using [tux](#api-tux).  See also [`io.print.*`](#api-io).

{{macros.parse_help('compose.mk', 'gum', github)}}

#### API: stream

The `stream.*` targets support IO streams, including basic stuff with JSON, newline-delimited, and space-delimited formats.

{{macros.parse_help('compose.mk', 'stream', github)}}

