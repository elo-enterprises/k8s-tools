##
# tests/docker-compose.yml: 
#  A minimal compose file that works with target dispatch
##
services:
  docker:
    build:
      context: .
      dockerfile_inline: |
        FROM docker
        RUN apk add --update --no-cache alpine-sdk bash
    entrypoint: bash
    working_dir: /workspace
    volumes:
      - ${PWD}:/workspace
      - /var/run/docker.sock:/var/run/docker.sock
  debian: &base
    hostname: debian 
    build:
      context: .
      dockerfile_inline: |
        FROM debian
        RUN apt-get update && apt-get install -y make
    entrypoint: bash
    working_dir: /workspace
    volumes:
      - ${PWD}:/workspace
  alpine:
    <<: *base
    hostname: alpine
    build:
      context: .
      dockerfile_inline: |
        FROM alpine
        RUN apk add --update --no-cache alpine-sdk bash
